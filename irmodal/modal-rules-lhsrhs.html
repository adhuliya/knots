<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Modal Labels/Rules</title>
    <!-- Bootstrap -->
    <!--<link href="../static/css/bootstrap.min.css" rel="stylesheet">-->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!--for jsMath - only one script required :) -->
    <script src="../static/js/jsMath-3.6e/easy/load.js"></script>

    <!--personal settings for ace editor and other stuff goes here-->
    <link rel="stylesheet" href="../static/css/mywiki.css">
  </head>
  <body>
    <div class="main">
      <h1>Modal Labels &amp; System Rules</h1>

      <table>
        <tr>
          <td colspan="3">
            <b>Prelude</b>
            <br> <br>

            <strong>Every IR statement is a set of actions.</strong>

            <ul>
              <li>
                $def(\textrm'x\textrm')$ : Variable 'x' is being defined.
              </li>

              <li>
                $use(\textrm'x\textrm')$ : Value in variable 'x' is used.
              </li>

              <li>
                $\$x,\ldots{}$ : Symbolic variables. They will be instantiated when binding with concrete statements and when being used in the rules.
                <br/>

                <li>
                  $\$lt1,\ \$rt1$ : Type variables. They will be instantiated when binding with concrete statements. It can be read as Lhs Type 1, Rhs Type 1. The name `lt1`, `rt1` only increase readability. They can be given any dollar prefixed name.

                  TODO: Some type variables may be related. Constraints have to be added for them.
                </li>

                <li>
                  $Variable Naming$ : Varialbe names start with a $\$$ and can be followed by, alphabets, numbers, dot, and underscore, in any order. Thus a varialbe name can even be a number. The variable $\$\_$ is special. Some valid examples are, $\$5$, $\$var.name$.
                </li>

                <li>
                  $Predicate Naming$ : Predicate names start with a lowercase alphabet, and may contain numbers, dot, underscore, in any order. Some valid examples are, "$type$", "$in.pointee$".
                </li>

                <li>
                  $in.pointee(\$x, \$y)$ : A predicate name can contain a dot. Good for readability.
                </li>
            </ul>

          </td>

        </tr>

        <tr>
          <th>Stmt/Expr</th>
          <th style="text-align:center;">Axiom Set</th>
          <th style="text-align:center;"><a href="#baserules">Base Rules</a> (broken down)</th>
        </tr>

        <tr>
          <td colspan="3">
            <b>LHS (of assignment stmt)</b>
          </td>

        </tr>

        <tr>
          <td>
            <span class="code">x</span>

            <div class="footnote">
              Variable assignment.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $def(\textrm'x\textrm'),$
              <br/> <br/>

              $type(\$lt0),$
              $type(\textrm'x\textrm',\ \$lt0).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $def(\$x) \wedge{} constrhs(\$y)$
              <hr class="rule">
              $svalue(\$x,\ \$y).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">*x</span>

            <div class="footnote">
              Assigning to a dereferenced location.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $lhsdref(\textrm'x\textrm'),$
              <br/> <br/>

              $use(\textrm'x\textrm'),$
              <br/> <br/>

              $type(\$lt0),$
              $type(\textrm'x\textrm',\ \$lt0^*).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $lhsdref(\$\_) \wedge{} var(\$x)$<br>
              $\wedge{} type(\$t) \wedge{} type(\$x, \$t)$<br>

              <hr class="rule">

              $sdef(\$x).$

            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr style="display:none;">
          <td>
            <span class="code">x[i]</span>

            <div class="footnote">
              Array assignment.
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $def.array,$
              $def,$
              <br/> <br/>

              $def(\textrm'x\textrm':\textrm'i\textrm'),$
              $def(\textrm'x\textrm'),$
              <br/> <br/>

              $use(\textrm'x\textrm'),$
              $use(\textrm'i\textrm'),$
              <br/> <br/>

              $type(\$lt0),$
              $type(\textrm'x\textrm':\textrm'i\textrm',\ \$lt0),$
              <br/>
              $type(\textrm'x\textrm',\ \$lt0^*).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr style="display:none;">
          <td>
            <span class="code">x.y</span>

            <div class="footnote">
              Structure member assignment.
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $def.mem,$
              $def,$
              <br/> <br/>

              $def(\textrm'x\textrm'.\textrm'y\textrm'),$
              <br/> <br/>

              $use(\textrm'x\textrm'),$
              <br/> <br/>

              $type(lhs,\ \$lt0),$
              $type(\textrm'x\textrm'.\textrm'y\textrm',\ \$lt0),$
              <br/>
              $type(\textrm'x\textrm',\ \$lt1).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr style="display:none;">
          <td>
            <span class="code">x-&gt;y</span>

            <div class="footnote">
              Structure pointee's member assignment.
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $def.pmem,$
              $def.mem,$
              <br/>
              $def,$
              <br/> <br/>

              $def(\textrm'x\textrm'::\textrm'y\textrm'),$
              <br/> <br/>

              $dref(\textrm'x\textrm'),$
              <br/> <br/>

              $use(\textrm'x\textrm'),$
              <br/> <br/>

              $type(lhs,\ \$lt0),$
              $type(\textrm'x\textrm'::\textrm'y\textrm',\ \$lt0),$
              <br/>
              $type(\textrm'x\textrm',\ \$lt1).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td colspan="3">
            <b>RHS (of assignment stmt)</b>
          </td>

        </tr>

        <tr>
          <td>
            <span class="code">literal</span>

            <div class="footnote">
              A literal.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $constrhs(lit(\textrm'literal\textrm')),$
              <br/> <br/>

              $type(\$rt0),$
              <br/>
              $type(lit(\textrm'literal\textrm'), \$rt0),$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>
          <td>
            <div style="text-align:center;">
              $use(\$x)$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">y</span>

            <div class="footnote">
              Variable use.
            </div>
          </td>
          <td>
            <div style="text-align:center;">

              $use(\textrm'y\textrm'),$
              <br/> <br/>

              $copyrhs(\textrm'y\textrm'),$
              <br/> <br/>

              $type(\$rt0),$
              $type(\textrm'y\textrm', \$rt0),$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>
          <td>
            <div style="text-align:center;">
              $use(\$x)$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr style="display:none;">
          <td>
            <span class="code">phi(y, z)</span>

            <div class="footnote">
              Phi selection.
            </div>
          </td>
          <td>
            <div style="text-align:center;">
              $expr.phi,$
              $expr,$
              <br/> <br/>

              $use(\textrm'y\textrm'),$
              $use(\textrm'z\textrm'),$
              <br/> <br/>

              $type(rhs,\ \$rt0),$
              $type(\textrm'y\textrm', \$rt0),$
              <br/>
              $type(\textrm'z\textrm', \$rt0).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>
          <td>
            <div style="text-align:center;">
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">*z</span>

            <div class="footnote">
              Pointee usage.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $lhsdref(\textrm'z\textrm'),$
              <br/> <br/>

              $use(\textrm'z\textrm'),$
              <br/> <br/>

              $type(\$rt0),$
              $type(\textrm'z\textrm',\ \$rt0^*).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $(use(\$x))$<br>
              $\vee{}$<br>
              $(lhsdref(\$\_) \wedge{} var(\$x)$<br>
              $\wedge{} type(\$t) \wedge{} type(\$x, \$t))$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">&amp;a</span>

            <div class="footnote">
              Address of.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $addrOf(\textrm'a\textrm'),$
              <br/> <br/>

              $type(\$rt0),$
              $type(\textrm'a\textrm',\ ^*\$rt0).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $use(\$x)$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">&lt;uniop&gt; a</span>

            <div class="footnote">
              Unary operator: minus, logical not, or bitwise not.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $use(\textrm'a\textrm'),$
              <br/> <br/>

              $op(\textrm'uniop\textrm', UniOp),$
              <br/> <br/>

              $oprnd(1, \textrm'a\textrm'),$
              <br/> <br/>

              $type(\$rt0),$
              $type(\textrm'a\textrm',\ \$rt1).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $use(\$x)$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">a &lt;binop&gt; b</span>

            <div class="footnote">
              Binary non-relational operator.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $use(\textrm'a\textrm'),$
              $use(\textrm'b\textrm'),$
              <br/> <br/>

              $op(\textrm'binop\textrm', BinOp),$
              <br/> <br/>

              $oprnd(1, \textrm'a\textrm'),$
              $oprnd(2, \textrm'b\textrm'),$
              <br/> <br/>

              $type(\$rt0),$
              <br/>
              $type(\textrm'a\textrm',\ \$rt0),$
              $type(\textrm'b\textrm',\ \$rt0).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $use(\$x)$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">a &lt;relop&gt; b</span>

            <div class="footnote">
              Binary relational operator.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $use(\textrm'a\textrm'),$
              $use(\textrm'b\textrm'),$
              <br/> <br/>

              $op(\textrm'relop\textrm', RelOp),$
              <br/> <br/>

              $oprnd(1, \textrm'a\textrm'),$
              $oprnd(2, \textrm'b\textrm'),$
              <br/> <br/>

              $type(Bool),$
              <br/>
              $type(\textrm'a\textrm',\ \$rt1),$
              $type(\textrm'b\textrm',\ \$rt1).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $use(\$x)$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr style="display:none;">
          <td>
            <span class="code">&amp;(x[i])</span>

            <div class="footnote">
              Take address of an array element.
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $expr.addrof.arr,$
              $expr.addrof,$
              $expr,$
              <br/> <br/>

              $addrOf(\textrm'x\textrm':\textrm'i\textrm'),$
              <br/> <br/>

              $use(\textrm'x\textrm'),$
              $use(\textrm'i\textrm'),$
              <br/> <br/>

              $type(rhs,\ \$rt0),$
              $type(\textrm'x\textrm',\ \$rt0),$
              $type(\textrm'i\textrm',\ \$rt0^*).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr style="display:none;">
          <td>
            <span class="code">&amp;(x.y)</span>

            <div class="footnote">
              Take address of a struct element.
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $expr.addrof.mem,$
              $expr.addrof,$
              $expr,$
              <br/> <br/>

              $addrOf(\textrm'x\textrm'.\textrm'y\textrm'),$
              <br/> <br/>

              $use(\textrm'x\textrm'),$
              <br/> <br/>

              $type(rhs,\ \$rt0),$
              $type(\textrm'x.y\textrm',\ *\$rt0),$
              $type(\textrm'x\textrm',\ \$rt1).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr style="display:none;">
          <td>
            <span class="code">func(x, 23)</span>

            <div class="footnote">
              Function Call.
            </div>
          </td>
          <td>
            <div style="text-align:center;">
              $call,$
              $expr.call,$
              $expr,$
              <br/> <br/>

              $arg(1,\ \textrm'x\textrm'),$
              $arg(2,\ lit(\textrm'23\textrm')),$
              <br/> <br/>

              $use(\textrm'func\textrm'),$
              $use(\textrm'x\textrm'),$
              <br/> <br/>

              $type(rhs,\ \$rt0),$
              $type(\textrm'func\textrm',\ \$rt1),$
              <br/>
              $type(\textrm'x\textrm',\ \$rt2),$
              $type(lit(\textrm'23\textrm'), \$rt3).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>
          <td>
            <div style="text-align:center;">
              $type(\$x, Func^*) \wedge{} in.pointee(\$x,\ \$y)$
              <hr class="rule"/>
              $callee(\$y).$
              <br/> <br/>

              $callee(\$x) \wedge{} callee(\$y)$
              <br/>
              $\wedge{} distinct(\$x,\ \$y)$
              <hr class="rule"/>
              $dynCall.$
              <br/> <br/>

              $type(rhs, Pointer) \wedge{} in.pointee(rhs,\ \$y)$
              <hr class="rule"/>
              $addrOf(\$y).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td colspan="3">
            <b>Others (control flow statements)</b>
          </td>

        </tr>

        <tr>
          <td>
            <span class="code">goto L1</span>

            <div class="footnote">
              unconditional jump.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $br(uncond,\ lit(\textrm'L1\textrm')),$
              $goto(lit(\textrm'L1\textrm')),$
              <br/> <br/>

              $type(lit(\textrm'L1\textrm'),\ Label).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">if b then L1 else L2</span>

            <div class="footnote">
              if condition.
            </div>
          </td>

          <td>
            <div style="text-align:center;">

              $br(true,\ \textrm'L1\textrm'),$
              $br(false,\ \textrm'L2\textrm'),$
              <br/> <br/>

              $use(\textrm'b\textrm'),$
              <br/> <br/>

              $type(\textrm'b\textrm',\ Bool),$
              $type(lit(\textrm'L1\textrm'), Label),$
              <br>
              $type(lit(\textrm'L2\textrm'), Label).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $use(\$x)$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr style="display:none;">
          <td>
            <span class="code">switch x &lt;default L0, 23 L1, 32 L2&gt;</span>

            <div class="footnote">
              switch case.
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $br.switch,$
              $br,$
              $switch,$
              <br/> <br/>

              $use(\textrm'x\textrm'),$
              <br/> <br/>

              $br(default,\ \textrm'L0\textrm'),$
              $br(lit(\textrm'23\textrm'),\ lit(\textrm'L1\textrm')),$
              <br/>
              $br(lit(\textrm'32\textrm'),\ lit(\textrm'L2\textrm')),$
              <br/> <br/>

              $type(\textrm'x\textrm',\ \$rt1),$
              $type(lit(\textrm'23\textrm'), \$rt1),$
              <br/>
              $type(lit(\textrm'32\textrm'), \$rt1),$
              <br/>
              $type(lit(\textrm'L0\textrm'), Label),$
              $type(lit(\textrm'L0\textrm'), Label).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <span class="code">return x</span>

            <div class="footnote">
              function return.
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $br.return,$
              $br,$
              $return,$
              <br/> <br/>

              $br(uncond, caller),$
              $return(caller),$
              <br/> <br/>

              $use(\textrm'x\textrm'),$
              <br/> <br/>

              $type(\textrm'x\textrm',\ \$rt0).$
            </div>

            <div class="footnote">
              Set of axioms : $A$
            </div>
          </td>

          <td>
            <div style="text-align:center;">
              $use(\$x)$
              <hr class="rule">
              $suse(\$x).$
            </div>

            <div class="footnote">
              Rules.
            </div>
          </td>
        </tr>

      </table>

      <br><br>
      <h2 id="baserules">Base rules,</h2>
      <div style="text-align:center;">
        <h3 style="text-align:left;">Reading from a location:</h3>
        $(use(\$x))$<br>

        $\vee{}$<br>
        $(rhsdref(\$\_) \wedge{} var(\$x)$<br>
        $\wedge{} type(\$t) \wedge{} type(\$x, \$t))$

        <hr class="rule">

        $suse(\$x).$

        <br><br><br>
        <h3 style="text-align:left;">Writing to a location:</h3>
        $(def(\$x))$<br>

        $\vee{}$<br>
        $(lhsdref(\$\_) \wedge{} var(\$x)$<br>
        $\wedge{} type(\$t) \wedge{} type(\$x, \$t))$<br>

        <hr class="rule">

        $sdef(\$x).$

        <br><br><br>
        <h3 style="text-align:left;">Value of a location:</h3>
        $svalue(\$x, lit(\$y))$<br>

      </div>

      <br><br><br>

      <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
      <script src="../static/js/jquery-3.3.1.min.js"></script>
      <!-- Include all compiled plugins (below), or include individual files as needed -->
      <!--<script src="../static/js/bootstrap.min.js"></script>-->
    </div>
  </body>
</html>


